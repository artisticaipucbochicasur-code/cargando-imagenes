<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Las Aventuras de El√≠zabeth</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: #aee1f9;
    font-family: "Comic Sans MS", sans-serif;
    user-select: none;
    touch-action: none;
  }
  canvas {
    background-size: cover;
    background-position: center;
  }
  #controls {
    position: fixed;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 10px;
    z-index: 5;
  }
  button {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    border: none;
    background: rgba(255,255,255,0.7);
    font-size: 24px;
  }
  #message {
    position: fixed;
    top: 10px;
    width: 100%;
    text-align: center;
    font-size: 24px;
    color: #fff;
    text-shadow: 2px 2px 4px #000;
  }
  #menu {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: linear-gradient(#8fd3f4, #84fab0);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }
  #menu h1 {
    font-size: 36px;
    color: #fff;
    text-shadow: 2px 2px 6px #000;
  }
  #menu button {
    margin-top: 15px;
    font-size: 20px;
    padding: 10px 20px;
    border-radius: 10px;
  }
</style>
</head>
<body>
<div id="menu">
  <h1>üå∏ Las Aventuras de El√≠zabeth üå∏</h1>
  <button onclick="startGame()">Comenzar aventura</button>
</div>

<canvas id="game" width="360" height="640"></canvas>
<div id="message"></div>

<div id="controls">
  <button id="left">‚¨ÖÔ∏è</button>
  <button id="up">‚¨ÜÔ∏è</button>
  <button id="down">‚¨áÔ∏è</button>
  <button id="right">‚û°Ô∏è</button>
</div>

<audio id="okSound" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_0f8723a118.mp3?filename=success-1-6297.mp3"></audio>
<audio id="errorSound" src="https://cdn.pixabay.com/download/audio/2021/08/09/audio_1e52b8447d.mp3?filename=oh-no-113105.mp3"></audio>
<audio id="clapSound" src="https://cdn.pixabay.com/download/audio/2021/09/01/audio_44b67a3d63.mp3?filename=applause-3-16978.mp3"></audio>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const msg = document.getElementById("message");
const menu = document.getElementById("menu");

let level = 1;
let playing = false;
let collected = 0;

const levels = [
  { bg: "https://i.imgur.com/tlW1f3T.png", goal: "flores", count: 3 },
  { bg: "https://i.imgur.com/ZbZ5yhk.png", goal: "ayudar al conejo", count: 2 },
  { bg: "https://i.imgur.com/z2jZzTk.png", goal: "cruzar el r√≠o", count: 4 },
  { bg: "https://i.imgur.com/9C0b3Oh.png", goal: "entregar la carta", count: 2 },
  { bg: "https://i.imgur.com/VUjbbhQ.png", goal: "encontrar la gema", count: 1 },
  { bg: "https://i.imgur.com/fqVDJKd.png", goal: "subir la monta√±a", count: 3 },
  { bg: "https://i.imgur.com/5DPU8Ae.png", goal: "encender antorchas", count: 3 },
  { bg: "https://i.imgur.com/YwQxIn2.png", goal: "encontrar la llave", count: 1 },
  { bg: "https://i.imgur.com/m50Z3PH.png", goal: "atrapar estrellas", count: 5 },
  { bg: "https://i.imgur.com/GcSmh5v.png", goal: "llegar a casa", count: 0 },
];

let player = { x: 150, y: 500, w: 40, h: 60, speed: 5, img: new Image() };
player.img.src = "https://i.imgur.com/h5Qrr4R.png"; // El√≠zabeth

let items = [];

function startGame() {
  menu.style.display = "none";
  playing = true;
  loadLevel(level);
}

function loadLevel(n) {
  const lvl = levels[n - 1];
  collected = 0;
  items = [];
  for (let i = 0; i < lvl.count; i++) {
    items.push({
      x: Math.random() * 300 + 20,
      y: Math.random() * 500 + 50,
      w: 30,
      h: 30,
      color: "yellow",
    });
  }
  canvas.style.backgroundImage = `url(${lvl.bg})`;
  msg.innerText = `Nivel ${n}: ${lvl.goal}`;
}

function draw() {
  if (!playing) return;
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.drawImage(player.img, player.x, player.y, player.w, player.h);

  ctx.fillStyle = "rgba(255,255,255,0.7)";
  ctx.font = "18px Comic Sans MS";
  ctx.fillText(`Flores: ${collected}/${levels[level - 1].count}`, 10, 20);

  ctx.fillStyle = "pink";
  items.forEach(it => ctx.fillRect(it.x, it.y, it.w, it.h));
}

function update() {
  if (!playing) return;
  items = items.filter(it => {
    if (player.x < it.x + it.w && player.x + player.w > it.x &&
        player.y < it.y + it.h && player.y + player.h > it.y) {
      collected++;
      document.getElementById("okSound").play();
      if (collected >= levels[level - 1].count) {
        levelUp();
      }
      return false;
    }
    return true;
  });
}

function levelUp() {
  document.getElementById("clapSound").play();
  msg.innerText = `¬°Excelente El√≠zabeth! Completaste el nivel ${level}!`;
  setTimeout(() => {
    if (level < 10) {
      level++;
      loadLevel(level);
    } else {
      msg.innerText = "üéâ ¬°Felicidades El√≠zabeth, completaste la aventura! üéâ";
      playing = false;
    }
  }, 2000);
}

function move(dir) {
  if (!playing) return;
  if (dir === "left" && player.x > 0) player.x -= player.speed;
  if (dir === "right" && player.x < canvas.width - player.w) player.x += player.speed;
  if (dir === "up" && player.y > 0) player.y -= player.speed;
  if (dir === "down" && player.y < canvas.height - player.h) player.y += player.speed;
  update();
  draw();
}

["left","right","up","down"].forEach(id => {
  document.getElementById(id).addEventListener("touchstart", () => move(id));
});

setInterval(draw, 50);
</script>
</body>
</html>
